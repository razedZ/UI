local success, HttpService = pcall(game.GetService, game, "HttpService")
local success2, TweenService = pcall(game.GetService, game, "TweenService")

if not (success and success2) or not HttpService or not TweenService then
    warn("Required services (HttpService or TweenService) are not available. Script will not function fully.")
    return
end

local PizdecWare = {}
PizdecWare.__index = PizdecWare

function PizdecWare:CreateWindow(guiName, infoText, saveFileName)
    local ScreenGui = Instance.new("ScreenGui")
    if not ScreenGui then return nil end
    ScreenGui.Parent = game:GetService("CoreGui")
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.Name = guiName

    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Color3.fromRGB(19, 21, 25)
    MainFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    MainFrame.BorderSizePixel = 0
    MainFrame.Position = UDim2.new(0.0323343836, 0, 0.194723621, 0)
    MainFrame.Size = UDim2.new(0, 630, 0, 460)
    MainFrame.BackgroundTransparency = 1

    local UICorner = Instance.new("UICorner")
    UICorner.Parent = MainFrame

    local Logo = Instance.new("Frame")
    Logo.Name = "Logo"
    Logo.Parent = MainFrame
    Logo.BackgroundColor3 = Color3.fromRGB(150, 17, 255)
    Logo.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Logo.BorderSizePixel = 0
    Logo.Position = UDim2.new(0.0215927847, 0, 0.0306019653, 0)
    Logo.Size = UDim2.new(0, 25, 0, 25)
    Logo.ZIndex = 3
    Logo.BackgroundTransparency = 0

    local UICorner_17 = Instance.new("UICorner")
    UICorner_17.Parent = Logo

    local W = Instance.new("TextLabel")
    W.Name = "W"
    W.Parent = Logo
    W.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    W.BackgroundTransparency = 1
    W.BorderColor3 = Color3.fromRGB(0, 0, 0)
    W.BorderSizePixel = 0
    W.Position = UDim2.new(0.28230226, 0, 0.75999999, 0)
    W.Size = UDim2.new(0, 23, 0, -14)
    W.ZIndex = 4
    W.Font = Enum.Font.SourceSansBold
    W.Text = "W"
    W.TextColor3 = Color3.fromRGB(0, 0, 0)
    W.TextSize = 20.000
    W.TextTransparency = 1

    local PizdecWareLabel = Instance.new("TextLabel")
    PizdecWareLabel.Name = "PizdecWare"
    PizdecWareLabel.Parent = Logo
    PizdecWareLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    PizdecWareLabel.BackgroundTransparency = 1
    PizdecWareLabel.BorderColor3 = Color3.fromRGB(0, 0, 0)
    PizdecWareLabel.BorderSizePixel = 0
    PizdecWareLabel.Position = UDim2.new(2.21097422, 0, 1.29638064, 0)
    PizdecWareLabel.Size = UDim2.new(0, 60, 0, -41)
    PizdecWareLabel.ZIndex = 4
    PizdecWareLabel.Font = Enum.Font.SourceSansBold
    PizdecWareLabel.Text = "PizdecWare"
    PizdecWareLabel.TextColor3 = Color3.fromRGB(150, 17, 255)
    PizdecWareLabel.TextSize = 25.000
    PizdecWareLabel.TextTransparency = 1

    local P = Instance.new("TextLabel")
    P.Name = "P"
    P.Parent = Logo
    P.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    P.BackgroundTransparency = 1
    P.BorderColor3 = Color3.fromRGB(0, 0, 0)
    P.BorderSizePixel = 0
    P.Position = UDim2.new(-0.304138184, 0, 0.75999999, 0)
    P.Size = UDim2.new(0, 27, 0, -14)
    P.ZIndex = 4
    P.Font = Enum.Font.SourceSansBold
    P.Text = "P"
    P.TextColor3 = Color3.fromRGB(255, 255, 255)
    P.TextSize = 20.000
    P.TextTransparency = 1

    local Info = Instance.new("TextLabel")
    Info.Name = "Info"
    Info.Parent = MainFrame
    Info.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Info.BackgroundTransparency = 1
    Info.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Info.BorderSizePixel = 0
    Info.Position = UDim2.new(0.0543069504, 0, 0.0833290443, 0)
    Info.Size = UDim2.new(0, 116, 0, 10)
    Info.Font = Enum.Font.SourceSansBold
    Info.Text = infoText or ""
    Info.TextColor3 = Color3.fromRGB(170, 176, 183)
    Info.TextSize = 10.000
    Info.TextXAlignment = Enum.TextXAlignment.Right
    Info.TextTransparency = 1

    local ElementContainer = Instance.new("Frame")
    ElementContainer.Name = "ElementContainer"
    ElementContainer.Parent = MainFrame
    ElementContainer.Active = true
    ElementContainer.BackgroundColor3 = Color3.fromRGB(23, 24, 28)
    ElementContainer.BorderColor3 = Color3.fromRGB(66, 63, 71)
    ElementContainer.BorderSizePixel = 0
    ElementContainer.LayoutOrder = 3
    ElementContainer.Position = UDim2.new(0.259076893, 0, 0.116228454, 0)
    ElementContainer.Size = UDim2.new(0, 460, 0, 400)
    ElementContainer.ZIndex = 3
    ElementContainer.BackgroundTransparency = 1

    local UICorner_2 = Instance.new("UICorner")
    UICorner_2.Parent = ElementContainer

    local UIStroke = Instance.new("UIStroke")
    UIStroke.Parent = ElementContainer
    UIStroke.Color = Color3.fromRGB(0, 0, 0)
    UIStroke.Transparency = 0.8
    UIStroke.Thickness = 1

    local Line = Instance.new("Frame")
    Line.Name = "Line"
    Line.Parent = ElementContainer
    Line.Active = true
    Line.BackgroundColor3 = Color3.fromRGB(23, 24, 28)
    Line.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Line.BorderSizePixel = 0
    Line.LayoutOrder = 3
    Line.Position = UDim2.new(1.32685116e-07, 0, -0.124946594, 0)
    Line.Size = UDim2.new(0, 0, 0, 57)
    Line.ZIndex = 3

    local UICorner_3 = Instance.new("UICorner")
    UICorner_3.Parent = Line

    local function fadeIn(element)
        if not TweenService then return end
        local tweenInfo = TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.In)
        local initialTransparency = element.BackgroundTransparency or 1
        if element:IsA("TextLabel") or element:IsA("TextButton") then
            local tween = TweenService:Create(element, tweenInfo, {
                TextTransparency = element.TextTransparency == 1 and 0 or element.TextTransparency
            })
            tween:Play()
            tween.Completed:Connect(function()
                element.BackgroundTransparency = initialTransparency == 1 ? 1 : 0 -- Восстанавливаем прозрачность только если она изначально была 1
                if element.TextTransparency == 0 then
                    element.TextTransparency = 0 -- Убеждаемся, что текст остаётся видимым
                end
            end)
        elseif element:IsA("ImageLabel") or element:IsA("ImageButton") then
            local tween = TweenService:Create(element, tweenInfo, {
                ImageTransparency = element.ImageTransparency == 1 and 0 or element.ImageTransparency
            })
            tween:Play()
            tween.Completed:Connect(function()
                element.BackgroundTransparency = initialTransparency == 1 ? 1 : 0 -- Восстанавливаем прозрачность только если она изначально была 1
                if element.ImageTransparency == 0 then
                    element.ImageTransparency = 0 -- Убеждаемся, что изображение остаётся видимым
                end
            end)
        else
            local tween = TweenService:Create(element, tweenInfo, {
                BackgroundTransparency = element.BackgroundTransparency == 1 and 0 or element.BackgroundTransparency
            })
            tween:Play()
            tween.Completed:Connect(function()
                element.BackgroundTransparency = initialTransparency == 1 ? 1 : 0 -- Восстанавливаем прозрачность только если она изначально была 1
            end)
        end
    end

    wait(0)
    fadeIn(MainFrame)
    fadeIn(Logo)
    fadeIn(W)
    fadeIn(PizdecWareLabel)
    fadeIn(P)
    fadeIn(Info)
    fadeIn(ElementContainer)
    fadeIn(Line)
    wait(1)

    local TabZone = Instance.new("Frame")
    TabZone.Name = "TabZone"
    TabZone.Parent = MainFrame
    TabZone.BackgroundColor3 = Color3.fromRGB(23, 24, 28)
    TabZone.BorderColor3 = Color3.fromRGB(0, 0, 0)
    TabZone.BorderSizePixel = 0
    TabZone.Position = UDim2.new(0, 0, 0.116228454, 0)
    TabZone.Size = UDim2.new(0, 163, 0, 399)
    TabZone.ZIndex = 4
    TabZone.BackgroundTransparency = 1 -- Прозрачность 1 изначально и всегда
    local UICorner_TabZone = Instance.new("UICorner")
    UICorner_TabZone.Parent = TabZone
    -- Не вызываем fadeIn для TabZone, чтобы не менять его прозрачность

    local Tabs = Instance.new("TextLabel")
    Tabs.Name = "Tabs"
    Tabs.Parent = TabZone
    Tabs.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Tabs.BackgroundTransparency = 1
    Tabs.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Tabs.BorderSizePixel = 0
    Tabs.Position = UDim2.new(0.0449740589, 0, 0.0100250627, 0)
    Tabs.Size = UDim2.new(0, 50, 0, 20)
    Tabs.Font = Enum.Font.ArialBold
    Tabs.Text = "Tabs"
    Tabs.TextColor3 = Color3.fromRGB(147, 152, 156)
    Tabs.TextSize = 14.000
    Tabs.TextTransparency = 0
    Tabs.TextXAlignment = Enum.TextXAlignment.Left
    Tabs.ZIndex = 5
    fadeIn(Tabs)

    local SelectedTab = Instance.new("Frame")
    SelectedTab.Name = "SelectedTab"
    SelectedTab.Parent = TabZone
    SelectedTab.BackgroundColor3 = Color3.fromRGB(150, 17, 255)
    SelectedTab.BackgroundTransparency = 0.900
    SelectedTab.BorderColor3 = Color3.fromRGB(0, 0, 0)
    SelectedTab.BorderSizePixel = 0
    SelectedTab.Position = UDim2.new(0, 0, 0.0476190485, 0)
    SelectedTab.Size = UDim2.new(0, 163, 0, 30)
    SelectedTab.ZIndex = 2
    fadeIn(SelectedTab)

    local ImageButton = Instance.new("ImageButton")
    ImageButton.Parent = MainFrame
    ImageButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ImageButton.BackgroundTransparency = 1
    ImageButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
    ImageButton.BorderSizePixel = 0
    ImageButton.Position = UDim2.new(0.949206471, 0, 0.0173913036, 0)
    ImageButton.Size = UDim2.new(0, 25, 0, 25)
    ImageButton.Image = "rbxassetid://12653789995"
    ImageButton.ImageTransparency = 1
    fadeIn(ImageButton)

    local currentTab = nil
    local function selectTab(tab, image)
        if TweenService then
            local tweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Linear)
            
            if tab ~= currentTab then
                for _, child in ipairs(TabZone:GetChildren()) do
                    if child:IsA("TextLabel") and child ~= Tabs then
                        local childImage = child:FindFirstChild("TabImage")
                        local textTween = TweenService:Create(child, tweenInfo, {
                            TextColor3 = Color3.fromRGB(147, 152, 156)
                        })
                        textTween:Play()
                        child.BackgroundTransparency = 1
                        
                        if childImage then
                            local imageTween = TweenService:Create(childImage, tweenInfo, {
                                ImageColor3 = Color3.fromRGB(147, 152, 156)
                            })
                            imageTween:Play()
                            childImage.BackgroundTransparency = 1
                        end
                    end
                end
                
                local tabTween = TweenService:Create(tab, tweenInfo, {
                    TextColor3 = Color3.fromRGB(150, 17, 255)
                })
                tabTween:Play()
                tab.BackgroundTransparency = 1
                
                local imageTween = TweenService:Create(image, tweenInfo, {
                    ImageColor3 = Color3.fromRGB(150, 17, 255)
                })
                imageTween:Play()
                image.BackgroundTransparency = 1

                local newPosition = UDim2.new(0, 0, tab.Position.Y.Scale, 0)
                local moveTween = TweenService:Create(SelectedTab, tweenInfo, { Position = newPosition })
                moveTween:Play()

                currentTab = tab
            else
                currentTab = tab
            end
        end
    end

    function PizdecWare:CreateTab(visualName, imageId)
        if not TweenService then return nil end
        local tabCount = #TabZone:GetChildren() - 2 -- Exclude Tabs and SelectedTab
        local spacing = 0.0902255669
        local initialOffset = 0.0501253121 + (Tabs.Size.Y.Scale * 2) - 0.0902255669 -- Поднимаем на 1 уровень вверх
        local newPosition = UDim2.new(0.30674848, 0, initialOffset + (tabCount * spacing), 0)
        
        local tab = Instance.new("TextLabel")
        tab.Name = visualName
        tab.Parent = TabZone
        tab.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        tab.BackgroundTransparency = 1
        tab.BorderColor3 = Color3.fromRGB(0, 0, 0)
        tab.BorderSizePixel = 0
        tab.Position = newPosition
        tab.Size = UDim2.new(0, 101, 0, 28)
        tab.Font = Enum.Font.SourceSansBold
        tab.Text = visualName
        tab.TextColor3 = Color3.fromRGB(147, 152, 156)
        tab.TextSize = 20.000
        tab.TextTransparency = 0
        tab.TextXAlignment = Enum.TextXAlignment.Left
        tab.ZIndex = 5
        fadeIn(tab)

        local image = Instance.new("ImageLabel")
        image.Name = "TabImage"
        image.Parent = tab
        image.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        image.BackgroundTransparency = 1
        image.BorderColor3 = Color3.fromRGB(0, 0, 0)
        image.BorderSizePixel = 0
        image.Position = UDim2.new(-0.364666939, 0, 0.036599841, 0)
        image.Size = UDim2.new(0, 26, 0, 26)
        image.ZIndex = 5
        image.Image = "rbxassetid://" .. imageId
        image.ImageColor3 = Color3.fromRGB(147, 152, 156)
        image.ImageTransparency = 0
        fadeIn(image)

        tab.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                selectTab(tab, image)
            end
        end)

        image.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                selectTab(tab, image)
            end
        end)

        if not currentTab then
            selectTab(tab, image)
        end

        return tab
    end

    return setmetatable({}, PizdecWare)
end

return PizdecWare
